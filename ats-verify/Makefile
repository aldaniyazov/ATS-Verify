.PHONY: build run dev docker-up docker-down clean

# Build the Go server binary
build:
	go build -o bin/server ./cmd/server

# Run the server locally
run: build
	./bin/server

# Run with hot reload (requires air: go install github.com/air-verse/air@latest)
dev:
	air -c .air.toml

# Start Docker containers (PostgreSQL + PgAdmin)
docker-up:
	docker compose up -d

# Stop Docker containers
docker-down:
	docker compose down

# Remove volumes (WARNING: deletes all data)
docker-clean:
	docker compose down -v

# Run tests
test:
	go test ./... -v

# Format code
fmt:
	go fmt ./...
	goimports -w .

# Lint
lint:
	golangci-lint run ./...

clean:
	rm -rf bin/
